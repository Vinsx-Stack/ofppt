<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shopping Cart</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
        crossorigin="anonymous">

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">

  <!-- keep yours if you have it -->
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="card.css">
</head>

<body>
  <nav class="navbar">
    <div class="navbar-container">
      <div class="logo">
        <a href="#" class="logo-link">LUXY SHOPPING CART</a>
      </div>
    </div>
  </nav>

  <main class="container cart-page">
    <h2 id="cartTitle" class="text-center mb-4 cart-title">
      Your Shopping Cart
    </h2>

    <!-- CART RENDER AREA -->
    <div id="cartApp"></div>

    <!-- EMPTY STATE (shown only if cart is empty) -->
    <section id="emptyState" class="empty-state">
      <div class="empty-wrap">
        <h2 class="text-center mb-4 empty-title">Your Shopping Cart is Empty</h2>

        <div class="empty-img-wrap">
          <img src="kettle-desaturated._CB424694058_.svg" alt="note" class="img">
        </div>

        <div class="empty-btn-wrap">
          <a href="index.html" target="_blank" rel="noopener">
            <button class="o">Continue Shopping</button>
          </a>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="footer-container" style="margin-top: 3rem; margin-bottom: 3rem; padding: 2rem; background-color: #f8f9fa; text-align: center;">
      <p>&copy; 2025 Luxy Shop. All rights reserved.</p>
      <ul class="footer-links" style="list-style: none; padding: 0; margin: 0; display: flex; gap: 1rem; justify-content: center;">
        <li><a href="#" style="text-decoration: none; font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;">Privacy Policy</a></li>
        <li><a href="#" style="text-decoration: none; font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;">Terms of Service</a></li>
        <li><a href="#" style="text-decoration: none; font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;">Contact Us</a></li>
      </ul>
    </div>
  </footer>

  <script>
    // Cart storage key used by product page
    const CART_KEY = "luxyCart";

    const cartApp = document.getElementById("cartApp");
    const emptyState = document.getElementById("emptyState");
    const cartTitle = document.getElementById("cartTitle");

    function getCart() {
      try {
        return JSON.parse(localStorage.getItem(CART_KEY) || "[]");
      } catch {
        return [];
      }
    }

    function saveCart(cart) {
      localStorage.setItem(CART_KEY, JSON.stringify(cart));

      // Keep your navbar badge counter in sync if you use cartCount there
      const totalQty = cart.reduce((sum, item) => sum + (Number(item.qty) || 0), 0);
      localStorage.setItem("cartCount", String(totalQty));
    }

    function money(n) {
      const num = Number(n) || 0;
      return "$" + num.toFixed(2);
    }

    function render() {
      const cart = getCart();

      if (!cart.length) {
        cartTitle.textContent = "";
        cartApp.innerHTML = "";
        emptyState.style.display = "block";
        return;
      }

      emptyState.style.display = "none";
      cartTitle.textContent = "Your Shopping Cart";

      const subtotal = cart.reduce((sum, item) => {
        const price = Number(item.price) || 0;
        const qty = Number(item.qty) || 1;
        return sum + price * qty;
      }, 0);

      cartApp.innerHTML = `
        <div class="cart-card">
          ${cart.map(item => {
            const itemTotal = (Number(item.price) || 0) * (Number(item.qty) || 1);
            return `
              <div class="cart-row">
                <div class="cart-left">
                  <img class="cart-img" src="${item.image || ""}" alt="${item.name || "Product"}"
                       onerror="this.style.display='none'">
                  <div class="cart-info">
                    <div class="cart-name">${item.name || "Product"}</div>
                    <div class="cart-price text-muted">${money(item.price)}</div>
                  </div>
                </div>

                <div class="cart-qty">
                  <button class="btn btn-outline-secondary btn-sm"
                          data-action="dec" data-id="${item.id}">-</button>
                  <span class="cart-qty-num">${Number(item.qty) || 1}</span>
                  <button class="btn btn-outline-secondary btn-sm"
                          data-action="inc" data-id="${item.id}">+</button>
                </div>

                <div class="cart-total">${money(itemTotal)}</div>

                <div class="cart-actions">
                  <button class="btn btn-outline-danger btn-sm"
                          data-action="remove" data-id="${item.id}">
                    Remove
                  </button>
                </div>
              </div>
            `;
          }).join("")}

          <div class="cart-summary">
            <div class="summary-row">
              <span class="text-muted">Subtotal</span>
              <span class="summary-amount">${money(subtotal)}</span>
            </div>

            <div class="summary-actions">
              <button class="btn btn-outline-dark" id="clearCartBtn">Clear cart</button>
              <button class="btn btn-dark" id="checkoutBtn" type="button">Checkout</button>
            </div>
          </div>
        </div>
      `;
    }

    document.addEventListener("click", (e) => {
      // Clear cart
      if (e.target && e.target.id === "clearCartBtn") {
        localStorage.removeItem(CART_KEY);
        localStorage.setItem("cartCount", "0");
        render();
        return;
      }

      // Cart actions (+ / - / remove)
      const actionBtn = e.target.closest("[data-action]");
      if (!actionBtn) return;

      const action = actionBtn.dataset.action;
      const id = actionBtn.dataset.id;

      const cart = getCart();
      const idx = cart.findIndex(item => String(item.id) === String(id));
      if (idx === -1) return;

      if (action === "inc") {
        cart[idx].qty = (Number(cart[idx].qty) || 1) + 1;
      } else if (action === "dec") {
        cart[idx].qty = Math.max(1, (Number(cart[idx].qty) || 1) - 1);
      } else if (action === "remove") {
        cart.splice(idx, 1);
      }

      saveCart(cart);
      render();
    });

    render();
  </script>
</body>
</html>
